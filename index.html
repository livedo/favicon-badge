<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <title>Favicon Badge</title>
    <link id="favicon" rel="icon" type="image/png" href="favicon.png" />
  </head>

  <body>

  <script>
  (function () {
  var canvas = document.createElement('canvas'),
      ctx,
      img = document.createElement('img'),
      link = document.getElementById('favicon').cloneNode(true);
    
  if (canvas.getContext) {
    canvas.height = canvas.width = 16;
    ctx = canvas.getContext('2d');
    i=1;
    img.onload = function () {
      setInterval(function() {
        drawIconBadge();  
      }, 1000);
    };
    img.src = 'favicon.png';

  function drawIconBadge() {
    ctx.clearRect(0,0,16,16);
      ctx.drawImage(img, 0, 0);
      ctx.fillStyle = '#f00';
  //    ctx.arc(4,12,5,0,2*Math.PI, false);
  //    ctx.fill();
      ctx.font = 'bold 8px Helvetica, sans-serif';
      ctx.fillStyle = '#111';
      b = (i>9)?"9":i++;
    
      ctx.fillText(b, 12, 15);
      link.href = canvas.toDataURL('image/png');
      document.body.appendChild(link);
    }
  }
  })();
  </script>    
  </body>

</html>
